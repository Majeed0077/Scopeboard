exports.id=7372,exports.ids=[7372],exports.modules={63931:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,63642,23)),Promise.resolve().then(t.t.bind(t,87586,23)),Promise.resolve().then(t.t.bind(t,47838,23)),Promise.resolve().then(t.t.bind(t,58057,23)),Promise.resolve().then(t.t.bind(t,77741,23)),Promise.resolve().then(t.t.bind(t,13118,23))},26617:(e,r,t)=>{Promise.resolve().then(t.bind(t,17818)),Promise.resolve().then(t.bind(t,67846))},67846:(e,r,t)=>{"use strict";t.d(r,{ThemeProvider:()=>a});var n=t(97247);t(28964);var i=t(57797);function a({children:e}){return n.jsx(i.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,storageKey:"vaultflow-theme",disableTransitionOnChange:!0,children:e})}},35246:(e,r,t)=>{"use strict";t.d(r,{ThemeToggle:()=>m});var n=t(97247),i=t(28964),a=t(12662),s=t(5495),o=t(61481),d=t(28852),l=t(5027),c=t(70887),u=t(57797);function m(){let{resolvedTheme:e,setTheme:r}=(0,u.F)(),[t,m]=i.useState(!1);if(i.useEffect(()=>{m(!0)},[]),!t)return n.jsx(d.z,{variant:"ghost",size:"icon","aria-label":"Toggle theme",disabled:!0,children:n.jsx(a.Z,{className:"h-4 w-4"})});let p="dark"===e,f=p?s.Z:a.Z,w=p?"Switch to light":"Switch to dark";return n.jsx(c.pn,{children:(0,n.jsxs)(c.u,{children:[(0,n.jsxs)(l.h_,{children:[n.jsx(c.aJ,{asChild:!0,children:n.jsx(l.$F,{asChild:!0,children:n.jsx(d.z,{variant:"ghost",size:"icon","aria-label":w,children:n.jsx(f,{className:"h-4 w-4"})})})}),(0,n.jsxs)(l.AW,{align:"end",children:[(0,n.jsxs)(l.Xi,{onClick:()=>r("light"),children:[n.jsx(a.Z,{className:"mr-2 h-4 w-4"}),"Light"]}),(0,n.jsxs)(l.Xi,{onClick:()=>r("dark"),children:[n.jsx(s.Z,{className:"mr-2 h-4 w-4"}),"Dark"]}),(0,n.jsxs)(l.Xi,{onClick:()=>r("system"),children:[n.jsx(o.Z,{className:"mr-2 h-4 w-4"}),"System"]})]})]}),n.jsx(c._v,{children:w})]})})}},28852:(e,r,t)=>{"use strict";t.d(r,{z:()=>l});var n=t(97247),i=t(28964),a=t(69008),s=t(87972),o=t(40677);let d=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",outline:"border border-input bg-background hover:bg-accent",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-6",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=i.forwardRef(({className:e,variant:r,size:t,asChild:i=!1,...s},l)=>{let c=i?a.g7:"button";return n.jsx(c,{className:(0,o.cn)(d({variant:r,size:t,className:e})),ref:l,...s})});l.displayName="Button"},5027:(e,r,t)=>{"use strict";t.d(r,{$F:()=>d,AW:()=>l,VD:()=>u,Xi:()=>c,h_:()=>o});var n=t(97247),i=t(28964),a=t(50525),s=t(40677);let o=a.fC,d=a.xz,l=i.forwardRef(({className:e,sideOffset:r=4,...t},i)=>n.jsx(a.Uv,{children:n.jsx(a.VY,{ref:i,sideOffset:r,className:(0,s.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-background p-1 text-foreground shadow-lg",e),...t})}));l.displayName=a.VY.displayName;let c=i.forwardRef(({className:e,...r},t)=>n.jsx(a.ck,{ref:t,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r}));c.displayName=a.ck.displayName;let u=i.forwardRef(({className:e,...r},t)=>n.jsx(a.Z0,{ref:t,className:(0,s.cn)("-mx-1 my-1 h-px bg-muted",e),...r}));u.displayName=a.Z0.displayName},70887:(e,r,t)=>{"use strict";t.d(r,{_v:()=>c,aJ:()=>l,pn:()=>o,u:()=>d});var n=t(97247),i=t(28964),a=t(132),s=t(40677);let o=a.zt,d=a.fC,l=a.xz,c=i.forwardRef(({className:e,sideOffset:r=6,...t},i)=>n.jsx(a.h_,{children:n.jsx(a.VY,{ref:i,sideOffset:r,className:(0,s.cn)("z-50 overflow-hidden rounded-md border border-slate-200 bg-background px-3 py-1.5 text-xs text-foreground shadow-lg",e),...t})}));c.displayName=a.VY.displayName},40677:(e,r,t)=>{"use strict";t.d(r,{cn:()=>a});var n=t(61929),i=t(35770);function a(...e){return(0,i.m6)((0,n.W)(e))}},39707:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o,metadata:()=>s});var n=t(72051),i=t(17583);let a=(0,t(45347).createProxy)(String.raw`F:\Coding\Flowlane\src\components\theme-provider.tsx#ThemeProvider`);t(5023);let s={title:"Flowlane",description:"Internal agency CRM dashboard"};function o({children:e}){return n.jsx("html",{lang:"en",suppressHydrationWarning:!0,children:(0,n.jsxs)("body",{className:"antialiased font-sans",children:[n.jsx(a,{children:e}),n.jsx(i.x7,{richColors:!0,closeButton:!0,position:"top-right"})]})})}},73275:(e,r,t)=>{"use strict";t.d(r,{KF:()=>S,MH:()=>y,XC:()=>b,Zk:()=>I,hg:()=>k,kt:()=>g,oT:()=>v,ts:()=>x,v6:()=>h});var n=t(52845),i=t(67370),a=t(32914),s=t(63253),o=t(82279),d=t(46993),l=t(48948);let c="vaultflow_session",u="vaultflow_workspace";function m(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET is not defined");return new TextEncoder().encode(e)}function p(e){return"owner"===e.toLowerCase()?"owner":"editor"}function f(e,r){if(!e)return"";for(let t of e.split(";").map(e=>e.trim()))if(t.startsWith(`${r}=`))return decodeURIComponent(t.slice(`${r}=`.length));return""}async function w(e,r,t){await (0,l.C)();let n=await s.T.findById(e).lean();if(!n||!n.isActive)return null;let i=t||r||n.workspaceId;if(i===n.workspaceId)return{workspaceId:i,role:p(n.role),email:n.email,name:n.name};let a=await d.N.findOne({userId:e,workspaceId:i,isActive:!0}).lean();return a?{workspaceId:i,role:"owner"===a.role?"owner":"editor",email:n.email,name:n.name}:{workspaceId:n.workspaceId,role:p(n.role),email:n.email,name:n.name}}async function g(e){let r=Math.floor(Date.now()/1e3);return new i.N(e).setProtectedHeader({alg:"HS256"}).setIssuedAt(r).setExpirationTime(r+604800).sign(m())}async function h(e){try{let r=e.headers.get("cookie"),t=f(r,c);if(!t)return null;let{payload:n}=await (0,a._)(t,m()),i="string"==typeof n.userId?n.userId:"",s="string"==typeof n.workspaceId?n.workspaceId:"",o=f(r,u);if(!i)return null;let d=await w(i,s,o);if(!d)return null;return{userId:i,workspaceId:d.workspaceId,role:d.role,email:d.email,name:d.name}}catch{return null}}async function v(e){let r=await h(e);if(!r)throw Error("Unauthorized");return r}async function y(e,r){let t=await v(e),n="owner"===r.toLowerCase()?"owner":"editor";if(t.role!==n)throw Error("Forbidden");return t}async function x(){let e=(0,n.cookies)(),r=e.get(c)?.value;if(!r)return null;try{let{payload:t}=await (0,a._)(r,m()),n="string"==typeof t.userId?t.userId:"",i="string"==typeof t.workspaceId?t.workspaceId:"",o=e.get(u)?.value??"";if(!n)return null;let d=await w(n,i,o);if(!d)return null;let l=await s.T.findById(n).lean();if(!l||!l.isActive)return null;return{id:String(l._id),workspaceId:d.workspaceId,name:l.name,email:l.email,role:d.role,avatarUrl:l.avatarUrl??""}}catch{return null}}async function k(){let e=await x();if(!e)return[];await (0,l.C)();let r=await s.T.findById(e.id).lean();if(!r)return[];let t=await d.N.find({userId:e.id,isActive:!0}).lean(),n=Array.from(new Set([String(r.workspaceId),...t.map(e=>String(e.workspaceId))])),i=await o.u.find({_id:{$in:n},isActive:!0}).lean();if(!i.some(e=>String(e._id)===String(r.workspaceId))){let e=await o.u.findOneAndUpdate({_id:String(r.workspaceId)},{_id:String(r.workspaceId),name:`${r.name}'s Workspace`,ownerUserId:String(r._id),isActive:!0},{upsert:!0,new:!0,setDefaultsOnInsert:!0}).lean();e&&i.push(e)}return n.map(n=>{let a=i.find(e=>String(e._id)===n),s=t.find(e=>String(e.workspaceId)===n),o=n===String(r.workspaceId)?"owner":s?.role==="owner"?"owner":"editor";return{id:n,name:a?.name??(n===String(r.workspaceId)?"My Workspace":`Workspace ${n.slice(0,6)}`),logoUrl:a?.logoUrl??"",role:o,isPersonal:n===String(r.workspaceId),isActive:n===e.workspaceId}})}async function b(){let e=await x();return e?.role??null}async function I(){return c}async function S(){return u}},48948:(e,r,t)=>{"use strict";t.d(r,{C:()=>o});var n=t(11185),i=t.n(n);let a=process.env.MONGODB_URI;if(!a)throw Error("MONGODB_URI is not defined");let s=global.mongoose??{conn:null,promise:null};async function o(){return s.conn||(s.promise||(s.promise=i().connect(a).then(e=>e)),s.conn=await s.promise,global.mongoose=s),s.conn}},63253:(e,r,t)=>{"use strict";t.d(r,{T:()=>s});var n=t(11185),i=t.n(n);let a=new n.Schema({email:{type:String,required:!0,lowercase:!0},name:{type:String,required:!0},role:{type:String,enum:["Owner","Editor"],required:!0},passwordHash:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},isActive:{type:Boolean,default:!0},invoiceEmailTemplate:{type:String,default:""},avatarUrl:{type:String,default:""}},{timestamps:!0});a.index({email:1},{unique:!0}),a.index({workspaceId:1,role:1}),a.index({workspaceId:1,isActive:1});let s=i().models.User||i().model("User",a)},82279:(e,r,t)=>{"use strict";t.d(r,{u:()=>s});var n=t(11185),i=t.n(n);let a=new n.Schema({_id:{type:String,required:!0},name:{type:String,required:!0},logoUrl:{type:String,default:""},ownerUserId:{type:String,required:!0},isActive:{type:Boolean,default:!0}},{timestamps:!0}),s=i().models.Workspace||i().model("Workspace",a)},46993:(e,r,t)=>{"use strict";t.d(r,{N:()=>s});var n=t(11185),i=t.n(n);let a=new n.Schema({userId:{type:String,required:!0,index:!0},workspaceId:{type:String,required:!0,index:!0},role:{type:String,enum:["owner","editor"],required:!0},isActive:{type:Boolean,default:!0},invitedById:{type:String,default:""}},{timestamps:!0});a.index({workspaceId:1,userId:1},{unique:!0}),a.index({userId:1,isActive:1});let s=i().models.WorkspaceMembership||i().model("WorkspaceMembership",a)},73881:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var n=t(54564);let i=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,n.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};