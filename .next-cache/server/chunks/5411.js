exports.id=5411,exports.ids=[5411],exports.modules={60467:(e,t,s)=>{Promise.resolve().then(s.bind(s,45887)),Promise.resolve().then(s.bind(s,78074)),Promise.resolve().then(s.bind(s,10278))},45887:(e,t,s)=>{"use strict";s.d(t,{AppProviders:()=>i});var r=s(97247),a=s(87774),n=s(75468);function i({children:e}){return r.jsx(n.f,{children:r.jsx(a.Q,{children:e})})}},79175:(e,t,s)=>{"use strict";s.d(t,{A:()=>p});var r=s(97247),a=s(28964),n=s(17818),i=s(28852),l=s(85426),o=s(92706),c=s(77081),d=s(70887),u=s(87774),m=s(75468),h=s(62714),x=s(58760);function p({children:e,open:t,onOpenChange:s}){let[p,f]=(0,a.useState)(!1),j="boolean"==typeof t,g=j?t:p,v=e=>{j?s?.(e):f(e)},y=(0,c.q)(),b=(0,o.Fs)(y,"contacts:create"),{addActivity:w}=(0,u.X)(),{contacts:N,setContacts:S}=(0,m.O)(),k=a.useRef(null);a.useEffect(()=>{function e(e){if("Escape"===e.key){v(!1);return}(e.metaKey||e.ctrlKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),v(!0))}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),a.useEffect(()=>{if(g)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e);function e(e){let t=e.target;!(t instanceof Element&&t.closest("[data-vf-select-content]"))&&k.current&&t&&!k.current.contains(t)&&v(!1)}},[g]),a.useEffect(()=>(g?(document.body.dataset.quickAddOpen="true",document.documentElement.dataset.quickAddOpen="true"):(delete document.body.dataset.quickAddOpen,delete document.documentElement.dataset.quickAddOpen),()=>{delete document.body.dataset.quickAddOpen,delete document.documentElement.dataset.quickAddOpen}),[g]);let[C,P]=(0,a.useState)(""),[A,O]=(0,a.useState)("referral"),[E,D]=(0,a.useState)(""),[T,_]=(0,a.useState)(!1),I=a.useRef(null);a.useEffect(()=>{T&&I.current?.focus()},[T]);let[U,L]=(0,a.useState)(new Date(Date.now()+1728e5).toISOString().slice(0,10)),$=(0,a.useMemo)(()=>!!(C.trim()&&U&&A&&("other"!==A||E.trim())),[C,U,A,E]);async function Q(){if(!$){n.A.error("Every lead must have a next follow-up.");return}let e="other"===A?{source:"other",sourceLabel:E.trim()}:{source:A,sourceLabel:void 0},t={id:`c-${Math.random().toString(36).slice(2,8)}`,name:C.trim(),company:"New lead",email:"",phone:"",whatsapp:"",source:e.source,sourceLabel:e.sourceLabel,stage:"new",nextFollowUpAt:new Date(U).toISOString(),tags:[],notes:[],archived:!1};try{let e=await h.h.createContact(t);S([e,...N]),h.h.createNotification({title:"New lead captured",body:`${e.name} - ${e.source}`,type:"lead_created",entityType:"contact",entityId:e.id}).catch(()=>void 0),n.A.success("Lead captured.")}catch{n.A.error("Unable to create lead.");return}w({entityType:"contact",entityId:t.id,action:"Lead created",meta:`${t.name} - ${t.source}`}),v(!1)}if(!b){let t=e&&"string"!=typeof e?a.cloneElement(e,{disabled:!0}):r.jsx(i.z,{disabled:!0,children:e??"Quick Add"});return r.jsx(d.pn,{children:(0,r.jsxs)(d.u,{children:[r.jsx(d.aJ,{asChild:!0,children:t}),r.jsx(d._v,{children:"Owner only"})]})})}let z=e&&a.isValidElement(e)?a.cloneElement(e,{onClick:t=>{e.props.onClick?.(t),v(!0)}}):r.jsx(i.z,{onClick:()=>v(!0),children:"Quick Add"});return(0,r.jsxs)(r.Fragment,{children:[z,(0,r.jsxs)("div",{className:["fixed inset-y-0 right-0 z-50 h-screen w-[420px] border-l border-border shadow-xl glass","transition-transform duration-200 ease-out",g?"translate-x-0":"translate-x-full pointer-events-none"].join(" "),ref:k,role:"dialog","aria-modal":"false","aria-label":"Quick add","aria-hidden":!g,children:[(0,r.jsxs)("div",{className:"flex items-start justify-between border-b border-border px-6 py-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-semibold",children:"Quick Add"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Capture a lead in under 20 seconds."})]}),r.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>v(!1),children:"X"})]}),(0,r.jsxs)("div",{className:"px-6 py-5",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(l.I,{placeholder:"Name *",value:C,onChange:e=>P(e.target.value)}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Source"}),(0,r.jsxs)(x.Ph,{value:A,onValueChange:e=>{O(e),"other"===e?(_(!1),setTimeout(()=>_(!0),0)):_(!1)},children:[r.jsx(x.i4,{children:r.jsx(x.ki,{placeholder:"Select source"})}),(0,r.jsxs)(x.Bw,{children:[r.jsx(x.Ql,{value:"upwork",children:"Upwork"}),r.jsx(x.Ql,{value:"linkedin",children:"LinkedIn"}),r.jsx(x.Ql,{value:"referral",children:"Referral"}),r.jsx(x.Ql,{value:"website",children:"Website"}),r.jsx(x.Ql,{value:"local",children:"Local"}),r.jsx(x.Ql,{value:"event",children:"Event"}),r.jsx(x.Ql,{value:"partner",children:"Partner"}),r.jsx(x.Ql,{value:"other",children:"Other"})]})]})]}),T?(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Specify source"}),r.jsx(l.I,{ref:I,placeholder:"e.g. Facebook group, Cold email",value:E,onChange:e=>D(e.target.value)})]}):null,r.jsx(l.I,{type:"date",value:U,onChange:e=>L(e.target.value)})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-2",children:[r.jsx(i.z,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),r.jsx(i.z,{onClick:Q,disabled:!$,children:"Save"})]})]})]})]})}},78074:(e,t,s)=>{"use strict";s.d(t,{Sidebar:()=>D});var r=s(97247),a=s(79906),n=s(44597),i=s(34178),l=s(37073),o=s(96582),c=s(90209),d=s(35571),u=s(57989),m=s(20977),h=s(650),x=s(7553),p=s(16927),f=s(17316),j=s(68918),g=s(23264),v=s(98588),y=s(999),b=s(69964),w=s(40677),N=s(28852),S=s(28964),k=s(87597),C=s(75468),P=s(17818);let A=[{href:"/chat",label:"Chat",icon:l.Z},{href:"/today",label:"Today",icon:o.Z},{href:"/dashboard",label:"Dashboard",icon:c.Z},{href:"/crm",label:"Pipeline",icon:d.Z},{href:"/contacts",label:"Contacts",icon:u.Z},{href:"/projects",label:"Projects",icon:m.Z},{href:"/admin/users",label:"Team",icon:h.Z}],O=[{href:"/invoices",label:"Invoices",icon:x.Z}],E=[{href:"/audit",label:"Audit Log",icon:p.Z},{href:"/admin/settings",label:"Admin Settings",icon:f.Z},{href:"/admin/billing",label:"Billing",icon:j.Z},{href:"/admin/backup",label:"Backup",icon:g.Z}];function D({initialRole:e}){let t=(0,i.usePathname)();(0,i.useRouter)();let[s,l]=(0,S.useState)(e??null),o="owner"===s,c=(0,S.useMemo)(()=>o?[...A,...O]:A,[o]),{contacts:d,projects:u,milestones:m,invoices:h}=(0,C.O)(),[x,p]=(0,S.useState)(0),[f,j]=(0,S.useState)(!1);return(0,r.jsxs)("aside",{className:(0,w.cn)("relative flex h-screen flex-col border-r bg-background py-6 transition-all duration-200",f?"w-16 px-2":"w-64 px-4"),children:[r.jsx("div",{className:"relative flex items-center justify-center",children:r.jsx("div",{className:(0,w.cn)("flex items-center",f?"justify-center":"px-2"),children:r.jsx("div",{className:(0,w.cn)("flex items-center rounded-xl bg-background",f?"h-10 w-10 justify-center":"h-12 w-[200px]"),children:r.jsx(n.default,{src:f?"/icon a.png":"/Logo.png",alt:"Flowlane",width:f?32:200,height:f?32:48,className:(0,w.cn)("object-contain",f?"h-8 w-8":"h-10 w-auto"),priority:!0})})})}),r.jsx(N.z,{variant:"ghost",size:"icon",className:(0,w.cn)("absolute right-3 text-muted-foreground hover:text-foreground",f?"top-16":"top-6"),onClick:()=>j(e=>!e),children:r.jsx(v.Z,{className:(0,w.cn)("h-4 w-4 transition-transform",!f&&"rotate-180")})}),(0,r.jsxs)("nav",{className:(0,w.cn)("mt-8 flex flex-1 flex-col gap-1",f&&"items-center"),children:[c.map(e=>{let s=t===e.href||t.startsWith(`${e.href}/`),n=e.icon;return(0,r.jsxs)(a.default,{href:e.href,prefetch:!0,className:(0,w.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",s&&"bg-muted text-foreground",f&&"w-10 justify-center px-0"),children:[r.jsx(n,{className:"h-4 w-4"}),f?null:r.jsx("span",{className:"flex-1",children:e.label}),"/chat"===e.href&&x>0?r.jsx(k.C,{variant:"secondary",children:x}):null]},e.href)}),o&&E.map(e=>{let s=t===e.href||t.startsWith(`${e.href}/`),n=e.icon;return(0,r.jsxs)(a.default,{href:e.href,prefetch:!0,className:(0,w.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",s&&"bg-muted text-foreground",f&&"w-10 justify-center px-0"),children:[r.jsx(n,{className:"h-4 w-4"}),f?null:e.label]},e.href)})]}),o&&!f&&(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)(N.z,{variant:"outline",className:"w-full justify-start gap-2 text-xs",onClick:()=>{let e=new Blob([JSON.stringify({contacts:d,projects:u,milestones:m,invoices:h},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="flowlane-data.json",s.click(),URL.revokeObjectURL(t)},children:[r.jsx(y.Z,{className:"h-4 w-4"}),"Export data"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 rounded-md border px-3 py-2 text-xs font-medium text-muted-foreground hover:bg-muted/60 cursor-pointer",children:[r.jsx(b.Z,{className:"h-4 w-4"}),"Import data",r.jsx("input",{type:"file",accept:"application/json",className:"hidden",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let s=new FileReader;s.onload=()=>{try{JSON.parse(s.result),P.A.message("Import is not available in live mode.")}catch{P.A.error("Invalid data file.")}},s.readAsText(t)}})]})]})]})}},10278:(e,t,s)=>{"use strict";s.d(t,{TopBar:()=>E});var r=s(97247),a=s(49256),n=s(99219),i=s(28633),l=s(17316),o=s(19400),c=s(44597),d=s(79906),u=s(28964),m=s(85426),h=s(79175),x=s(28852),p=s(70887),f=s(35246),j=s(17818),g=s(44211),v=s(51740),y=s(58760),b=s(75468),w=s(77081),N=s(62714);function S({open:e,onOpenChange:t}){let s=u.useRef(null),a="owner"===(0,w.q)(),{contacts:n,setProjects:i,setContacts:l}=(0,b.O)(),[o,c]=u.useState(""),[d,h]=u.useState(""),[p,f]=u.useState(""),[S,k]=u.useState(!1),[C,P]=u.useState(""),[A,O]=u.useState("referral"),[E,D]=u.useState(new Date(Date.now()+1728e5).toISOString().slice(0,10)),[T,_]=u.useState("planning"),[I,U]=u.useState(""),[L,$]=u.useState(""),[Q,z]=u.useState("USD"),[F,R]=u.useState(""),[J,Z]=u.useState(""),[B,q]=u.useState([]),[M,V]=u.useState(!1),[W,H]=u.useState(!1),X=u.useRef(null),K=o.trim().length>0;async function Y(e){if(e?.preventDefault(),!K){j.A.error("Project name is required.");return}let s=J.split("\n").map(e=>e.trim()).filter(Boolean).filter(e=>{try{return new URL(e),!0}catch{return!1}}),r={title:o.trim(),...p?{contactId:p}:{},...!p&&d.trim()?{clientName:d.trim()}:{},status:T,dueDate:I||new Date().toISOString(),startDate:new Date().toISOString(),notes:F.trim()||void 0,links:s.length?s:void 0,attachments:B.length?B:void 0,archived:!1,...a?{budgetAmount:L?Number(L):0,currency:Q}:{}};H(!0);try{let e=await N.h.createProject(r);i(t=>[e,...t]),N.h.createNotification({title:"New project created",body:e.title,type:"project_created",entityType:"project",entityId:e.id}).catch(()=>void 0),j.A.success("Project created."),t(!1),c(""),h(""),f(""),k(!1),P(""),O("referral"),D(new Date(Date.now()+1728e5).toISOString().slice(0,10)),_("planning"),U(""),$(""),z("USD"),R(""),Z(""),q([])}catch{j.A.error("Unable to create project.")}finally{H(!1)}}async function G(e){if(0!==e.length){V(!0);try{let t=new FormData;e.forEach(e=>t.append("files",e));let s=await fetch("/api/uploads",{method:"POST",body:t}),r=await s.json();if(!r?.success)throw Error(r?.error??"Upload failed");let a=Array.isArray(r.data)?r.data:[];q(e=>[...e,...a]),j.A.success("Files uploaded.")}catch(e){j.A.error(e instanceof Error?e.message:"Upload failed.")}finally{V(!1)}}}async function ee(){if(!C.trim()){j.A.error("Client name is required.");return}if(!E){j.A.error("Follow-up date is required.");return}let e={id:`c-${Math.random().toString(36).slice(2,8)}`,name:C.trim(),company:"New client",email:"",phone:"",whatsapp:"",source:A,stage:"new",nextFollowUpAt:new Date(E).toISOString(),tags:[],notes:[],archived:!1};try{let t=await N.h.createContact(e);l(e=>[t,...e]),f(t.id),h(""),j.A.success("Client created.")}catch{j.A.error("Unable to create client.");return}k(!1),P(""),O("referral"),D(new Date(Date.now()+1728e5).toISOString().slice(0,10))}async function et(e,t){q(e=>e.filter((e,s)=>s!==t));try{let t=await fetch("/api/uploads",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e.url})}),s=await t.json();if(!s?.success)throw Error(s?.error??"Unable to delete file");j.A.success("Attachment removed.")}catch(e){q(B),j.A.error(e instanceof Error?e.message:"Unable to remove attachment.")}}return u.useEffect(()=>{function s(e){"Escape"===e.key&&t(!1)}return e&&window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[e,t]),u.useEffect(()=>{if(e)return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r);function r(e){let r=e.target;!(r instanceof Element&&r.closest("[data-vf-select-content]"))&&s.current&&r&&!s.current.contains(r)&&t(!1)}},[e,t]),r.jsx("div",{className:["fixed inset-y-0 right-0 z-50 h-screen w-[420px] border-l border-border bg-background shadow-xl","transition-transform duration-200 ease-out",e?"translate-x-0":"translate-x-full pointer-events-none"].join(" "),ref:s,role:"dialog","aria-modal":"false","aria-label":"New project","aria-hidden":!e,children:(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"border-b border-border px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-semibold",children:"New Project"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Create a project with client context."})]}),r.jsx(x.z,{variant:"ghost",size:"icon",onClick:()=>t(!1),children:"X"})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:(0,r.jsxs)("form",{className:"space-y-6",onSubmit:Y,children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Project name"}),r.jsx(m.I,{value:o,onChange:e=>c(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Client name (optional)"}),r.jsx(m.I,{value:d,onChange:e=>h(e.target.value),placeholder:"e.g. Majeed, Flux Design Co.",disabled:!!p})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Select client (optional)"}),(0,r.jsxs)(y.Ph,{value:p||"",onValueChange:e=>{if("__clear__"===e){f("");return}if("__create__"===e){k(!0);return}f(e),h("")},children:[r.jsx(y.i4,{children:r.jsx(y.ki,{placeholder:"Select client (optional)"})}),(0,r.jsxs)(y.Bw,{children:[p?r.jsx(y.Ql,{value:"__clear__",children:"Clear selection"}):null,n.map(e=>r.jsx(y.Ql,{value:e.id,children:e.name},e.id)),r.jsx(y.Ql,{value:"__create__",children:"+ Create new contact"})]})]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Link this project to a client to track history, invoices, and follow-ups."}),S?(0,r.jsxs)("div",{className:"mt-3 rounded-xl border bg-background p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Client name"}),r.jsx(m.I,{value:C,onChange:e=>P(e.target.value),placeholder:"Client name"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Source"}),(0,r.jsxs)(y.Ph,{value:A,onValueChange:e=>O(e),children:[r.jsx(y.i4,{children:r.jsx(y.ki,{placeholder:"Source"})}),(0,r.jsxs)(y.Bw,{children:[r.jsx(y.Ql,{value:"upwork",children:"Upwork"}),r.jsx(y.Ql,{value:"linkedin",children:"LinkedIn"}),r.jsx(y.Ql,{value:"referral",children:"Referral"}),r.jsx(y.Ql,{value:"website",children:"Website"}),r.jsx(y.Ql,{value:"local",children:"Local"}),r.jsx(y.Ql,{value:"event",children:"Event"}),r.jsx(y.Ql,{value:"partner",children:"Partner"}),r.jsx(y.Ql,{value:"other",children:"Other"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Next follow-up"}),r.jsx(m.I,{type:"date",value:E,onChange:e=>D(e.target.value)})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx(x.z,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Cancel"}),r.jsx(x.z,{type:"button",onClick:ee,children:"Create contact"})]})]}):null]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Status"}),(0,r.jsxs)(y.Ph,{value:T,onValueChange:e=>_(e),children:[r.jsx(y.i4,{children:r.jsx(y.ki,{placeholder:"Status"})}),(0,r.jsxs)(y.Bw,{children:[r.jsx(y.Ql,{value:"planning",children:"Planning"}),r.jsx(y.Ql,{value:"active",children:"Active"}),r.jsx(y.Ql,{value:"on_hold",children:"On Hold"}),r.jsx(y.Ql,{value:"completed",children:"Completed"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Due date"}),r.jsx(m.I,{type:"date",value:I,onChange:e=>U(e.target.value)})]})]}),a?(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Budget amount"}),r.jsx(m.I,{type:"number",value:L,onChange:e=>$(e.target.value),placeholder:"Amount"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Currency"}),(0,r.jsxs)(y.Ph,{value:Q,onValueChange:z,children:[r.jsx(y.i4,{children:r.jsx(y.ki,{placeholder:"Currency"})}),(0,r.jsxs)(y.Bw,{children:[r.jsx(y.Ql,{value:"USD",children:"USD"}),r.jsx(y.Ql,{value:"PKR",children:"PKR"})]})]})]})]}):null,(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Description"}),r.jsx(g.g,{value:F,onChange:e=>R(e.target.value),onKeyDown:e=>e.stopPropagation()})]}),(0,r.jsxs)("details",{className:"rounded-xl border bg-background p-4",children:[r.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Links & attachments"}),(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Links"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Paste one URL per line."}),r.jsx(g.g,{value:J,onChange:e=>Z(e.target.value),placeholder:"https://figma.com/...\nhttps://github.com/...\nhttps://yourapp.com",onKeyDown:e=>e.stopPropagation()})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(v._,{children:"Attachments"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Upload files (PDF, DOCX, XLSX, images)."}),(0,r.jsxs)("div",{className:"rounded-xl border border-dashed border-border bg-background px-4 py-6 text-sm text-muted-foreground",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),G(Array.from(e.dataTransfer.files??[]))},onClick:()=>X.current?.click(),role:"button",tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),X.current?.click())},children:[r.jsx("p",{className:"font-medium text-foreground",children:M?"Uploading...":"Drag & drop files here or click to upload"}),r.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Multiple files supported."})]}),r.jsx("input",{ref:X,type:"file",multiple:!0,accept:".png,.jpg,.jpeg,.webp,.pdf,.doc,.docx,.xls,.xlsx",className:"hidden",onChange:function(e){G(Array.from(e.target.files??[])),e.target.value=""}}),0===B.length?r.jsx("p",{className:"text-xs text-muted-foreground",children:"No attachments yet."}):r.jsx("div",{className:"space-y-2",children:B.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-background px-3 py-2 text-xs",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-foreground",children:e.name}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:[(e.size/1024).toFixed(1)," KB"]})]}),r.jsx(x.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>et(e,t),children:"Remove"})]},`${e.url}-${t}`))})]})]})]})]})}),r.jsx("div",{className:"border-t border-border px-6 py-4",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx(x.z,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),r.jsx(x.z,{type:"submit",disabled:!K||W,onClick:Y,children:W?"Saving...":"Save project"})]})})]})})}var k=s(34178),C=s(81299),P=s(5027),A=s(35224);function O(){let[e,t]=(0,u.useState)([]),[s,a]=(0,u.useState)(0),[n,i]=(0,u.useState)(!1);return(0,r.jsxs)(P.h_,{onOpenChange:i,children:[r.jsx(P.$F,{asChild:!0,children:(0,r.jsxs)(x.z,{variant:"ghost",size:"icon",className:"relative rounded-full",children:[r.jsx(C.Z,{className:"h-4 w-4"}),s>0?r.jsx("span",{className:"absolute -right-0.5 -top-0.5 rounded-full bg-rose-500 px-1 text-[10px] text-white",children:s}):null]})}),(0,r.jsxs)(P.AW,{align:"end",className:"w-[320px]",children:[r.jsx("div",{className:"px-3 py-2 text-xs text-muted-foreground",children:"Notifications"}),r.jsx(P.VD,{}),0===e.length?r.jsx("div",{className:"px-3 py-3 text-xs text-muted-foreground",children:"No notifications yet."}):e.slice(0,8).map(e=>(0,r.jsxs)(P.Xi,{className:"flex flex-col items-start gap-1",children:[r.jsx("span",{className:"text-xs font-medium text-foreground",children:e.title}),r.jsx("span",{className:"text-[11px] text-muted-foreground",children:e.body}),r.jsx("span",{className:"text-[10px] text-muted-foreground",children:(0,A.p6)(e.createdAt)})]},e.id)),e.length>0?(0,r.jsxs)(r.Fragment,{children:[r.jsx(P.VD,{}),(0,r.jsxs)("div",{className:"px-3 py-2 text-[11px] text-muted-foreground",children:["Showing latest ",Math.min(e.length,8)]})]}):null]})]})}function E({initialRole:e,initialUser:t,initialWorkspaces:s=[],initialActiveWorkspaceId:j=""}){let[g,v]=(0,u.useState)(t??(e?{role:e}:null)),[b,w]=(0,u.useState)(""),N=(0,k.useRouter)(),[C,A]=(0,u.useState)(!1),[E,D]=(0,u.useState)(!1),[T,_]=(0,u.useState)(!1),[I,U]=(0,u.useState)(!1),[L,$]=(0,u.useState)(!1),[Q,z]=(0,u.useState)(s),[F,R]=(0,u.useState)(j),[J,Z]=(0,u.useState)(!1),[B,q]=(0,u.useState)(""),[M,V]=(0,u.useState)(!1),[W,H]=(0,u.useState)({contacts:[],projects:[],invoices:[]}),X=(0,u.useRef)(null),K=e=>{e&&A(!1),D(e)},Y=(0,u.useMemo)(()=>W.contacts.length+W.projects.length+W.invoices.length,[W]),G=(0,u.useMemo)(()=>Q.find(e=>e.id===F)??null,[Q,F]);async function ee(e){if(e){if("__create__"===e){Z(!0);return}if(e!==F){$(!0);try{let t=await fetch("/api/workspaces/switch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workspaceId:e})}),s=await t.json();if(!t.ok||!s?.success)throw Error(s?.error??"Unable to switch workspace.");R(e),N.refresh(),window.location.reload()}catch(e){console.error(e)}finally{$(!1)}}}}async function et(){let e=B.trim();if(!(e.length<2)){V(!0);try{let t=await fetch("/api/workspaces",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),s=await t.json();if(!t.ok||!s?.success)throw Error(s?.error??"Unable to create workspace.");let r=s?.data?.id,a=s?.data?.name;r&&(Z(!1),q(""),a&&window.dispatchEvent(new CustomEvent("vaultflow-workspace-updated",{detail:{workspaceId:r,name:a}})),await ee(r))}catch(e){console.error(e)}finally{V(!1)}}}async function es(){await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/"}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"sticky top-0 z-40 flex items-center justify-between border-b px-8 py-4 glass",children:[(0,r.jsxs)("div",{ref:X,className:"relative flex items-center gap-3 text-sm text-muted-foreground",children:[r.jsx(a.Z,{className:"h-4 w-4"}),r.jsx(m.I,{className:"h-9 w-[260px] border-none bg-muted/60",placeholder:"Search contacts, projects, invoices...",value:b,onChange:e=>w(e.target.value),onFocus:()=>{b.trim().length>=2&&_(!0)},onKeyDown:e=>{"Enter"===e.key&&b.trim()&&(N.push(`/search?q=${encodeURIComponent(b.trim())}`),_(!1))}}),T&&(0,r.jsxs)("div",{className:"absolute left-0 top-12 z-50 w-[420px] rounded-xl border bg-background shadow-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-2 text-xs text-muted-foreground",children:[r.jsx("span",{children:"Search results"}),I?r.jsx("span",{children:"Searching..."}):(0,r.jsxs)("span",{children:[Y," results"]})]}),(0,r.jsxs)("div",{className:"space-y-3 px-4 py-3 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Contacts"}),r.jsx("div",{className:"mt-2 space-y-1",children:0===W.contacts.length?r.jsx("p",{className:"text-xs text-muted-foreground",children:"No matches"}):W.contacts.slice(0,3).map(e=>(0,r.jsxs)(d.default,{href:`/contacts/${e.id}`,className:"block rounded-md px-2 py-1 text-foreground hover:bg-muted/60",onClick:()=>_(!1),children:[e.name,e.company?(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[" - ",e.company]}):null]},e.id))})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Projects"}),r.jsx("div",{className:"mt-2 space-y-1",children:0===W.projects.length?r.jsx("p",{className:"text-xs text-muted-foreground",children:"No matches"}):W.projects.slice(0,3).map(e=>r.jsx(d.default,{href:`/projects/${e.id}`,className:"block rounded-md px-2 py-1 text-foreground hover:bg-muted/60",onClick:()=>_(!1),children:e.title},e.id))})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Invoices"}),r.jsx("div",{className:"mt-2 space-y-1",children:0===W.invoices.length?r.jsx("p",{className:"text-xs text-muted-foreground",children:"No matches"}):W.invoices.slice(0,3).map(e=>r.jsx(d.default,{href:`/invoices/${e.id}`,className:"block rounded-md px-2 py-1 text-foreground hover:bg-muted/60",onClick:()=>_(!1),children:e.invoiceNo},e.id))})]})]}),r.jsx("div",{className:"border-t px-4 py-2 text-xs",children:(0,r.jsxs)(d.default,{href:`/search?q=${encodeURIComponent(b.trim())}`,className:"text-foreground hover:underline",onClick:()=>_(!1),children:["View all results ","->"]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[Q.length>0?(0,r.jsxs)(y.Ph,{value:F,onValueChange:ee,disabled:L,children:[r.jsx(y.i4,{className:"h-9 w-[240px]",children:r.jsx("div",{className:"flex min-w-0 items-center",children:r.jsx("span",{className:"truncate text-sm font-medium",children:G?.name??"Workspace"})})}),(0,r.jsxs)(y.Bw,{children:[Q.map(e=>r.jsx(y.Ql,{value:e.id,children:e.name},e.id)),r.jsx(y.Ql,{value:"__create__",children:"+ Create team"})]})]}):null,r.jsx(p.pn,{children:(0,r.jsxs)(p.u,{children:[r.jsx(p.aJ,{asChild:!0,children:r.jsx("div",{children:r.jsx(O,{})})}),r.jsx(p._v,{children:"Notifications"})]})}),r.jsx(p.pn,{children:(0,r.jsxs)(p.u,{children:[r.jsx(p.aJ,{asChild:!0,children:r.jsx(f.ThemeToggle,{})}),r.jsx(p._v,{children:"Theme"})]})}),(0,r.jsxs)(x.z,{variant:"outline",className:"gap-2",onClick:()=>K(!0),children:[r.jsx(n.Z,{className:"h-4 w-4"}),"New Project"]}),r.jsx(h.A,{open:C,onOpenChange:e=>{e&&D(!1),A(e)},children:r.jsx(x.z,{children:"Quick Add"})}),(0,r.jsxs)(P.h_,{children:[r.jsx(P.$F,{asChild:!0,children:r.jsx(x.z,{variant:"ghost",size:"icon",className:"h-9 w-9 overflow-hidden rounded-full border bg-muted/60 p-0",children:g?.avatarUrl?r.jsx(c.default,{src:g.avatarUrl,alt:g.name??"Profile",width:36,height:36,className:"h-9 w-9 object-cover"}):r.jsx("span",{className:"text-xs font-semibold",suppressHydrationWarning:!0,children:g?.name?.charAt(0)?.toUpperCase()??g?.role?.charAt(0)?.toUpperCase()??"U"})})}),(0,r.jsxs)(P.AW,{align:"end",className:"w-56",children:[r.jsx("div",{className:"px-2 py-1",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-sm font-medium",children:g?.name??"User"}),r.jsx("span",{className:"text-xs text-muted-foreground",children:g?.role??"member"})]})}),r.jsx(P.VD,{}),(0,r.jsxs)(P.Xi,{onClick:()=>N.push("/profile"),children:[r.jsx(i.Z,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,r.jsxs)(P.Xi,{onClick:()=>N.push("/profile"),children:[r.jsx(l.Z,{className:"mr-2 h-4 w-4"}),"Settings"]}),r.jsx(P.VD,{}),(0,r.jsxs)(P.Xi,{onClick:es,children:[r.jsx(o.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})]})]}),J?r.jsx("div",{className:"fixed inset-0 z-[60] flex items-start justify-center pt-24",children:(0,r.jsxs)("div",{className:"w-[420px] rounded-xl border bg-background p-5 shadow-xl",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm font-semibold",children:"Create team"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter a name for your new team workspace."})]}),r.jsx("div",{className:"mt-4 space-y-2",children:r.jsx(m.I,{value:B,onChange:e=>q(e.target.value),placeholder:"Team name",autoFocus:!0})}),(0,r.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[r.jsx(x.z,{variant:"outline",onClick:()=>{Z(!1),q("")},disabled:M,children:"Cancel"}),r.jsx(x.z,{onClick:et,disabled:M||B.trim().length<2,children:M?"Creating...":"Create team"})]})]})}):null,r.jsx(S,{open:E,onOpenChange:K})]})}},87597:(e,t,s)=>{"use strict";s.d(t,{C:()=>l});var r=s(97247),a=s(87972),n=s(40677);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium transition-colors",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground",outline:"text-foreground",success:"border-transparent bg-emerald-500/10 text-emerald-700",warning:"border-transparent bg-amber-500/10 text-amber-700",info:"border-transparent bg-blue-500/10 text-blue-700",muted:"border-transparent bg-muted text-muted-foreground",danger:"border-transparent bg-rose-500/10 text-rose-700"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...s}){return r.jsx("div",{className:(0,n.cn)(i({variant:t,className:e})),...s})}},85426:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});var r=s(97247),a=s(28964),n=s(40677);let i=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));i.displayName="Input"},51740:(e,t,s)=>{"use strict";s.d(t,{_:()=>n});var r=s(97247);s(28964);var a=s(40677);function n({className:e,...t}){return r.jsx("label",{className:(0,a.cn)("text-sm font-medium leading-none text-foreground",e),...t})}},58760:(e,t,s)=>{"use strict";s.d(t,{Bw:()=>m,Ph:()=>c,Ql:()=>h,i4:()=>u,ki:()=>d});var r=s(97247),a=s(28964),n=s(94765),i=s(62513),l=s(48799),o=s(40677);let c=n.fC;n.ZA;let d=n.B4,u=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(n.xz,{ref:a,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:[t,r.jsx(n.JO,{asChild:!0,children:r.jsx(i.Z,{className:"h-4 w-4 text-muted-foreground"})})]}));u.displayName=n.xz.displayName;let m=a.forwardRef(({className:e,children:t,position:s="popper",...a},i)=>r.jsx(n.h_,{children:r.jsx(n.VY,{ref:i,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-background text-foreground shadow-lg",e),"data-vf-select-content":!0,position:s,...a,children:r.jsx(n.l_,{className:"p-1",children:t})})}));m.displayName=n.VY.displayName;let h=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(n.ck,{ref:a,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(n.wU,{children:r.jsx(l.Z,{className:"h-4 w-4"})})}),r.jsx(n.eT,{children:t})]}));h.displayName=n.ck.displayName},44211:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});var r=s(97247),a=s(28964),n=s(40677);let i=a.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{ref:s,className:(0,n.cn)("min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t}));i.displayName="Textarea"},87774:(e,t,s)=>{"use strict";s.d(t,{Q:()=>l,X:()=>o});var r=s(97247),a=s(28964),n=s(62714);let i=a.createContext(null);function l({children:e}){let[t,s]=a.useState([]);a.useEffect(()=>{let e=!0;return n.h.getActivities().then(t=>{e&&s(t??[])}).catch(()=>void 0),()=>{e=!1}},[]);let l=a.useCallback(e=>{let t={createdAt:e.createdAt??new Date().toISOString(),...e};n.h.createActivity(t).then(e=>{s(t=>[e,...t])}).catch(()=>void 0)},[]),o=a.useCallback((e,s)=>t.filter(t=>t.entityType===e&&t.entityId===s),[t]);return r.jsx(i.Provider,{value:{activities:t,addActivity:l,getByEntity:o},children:e})}function o(){let e=a.useContext(i);if(!e)throw Error("useActivity must be used within ActivityProvider");return e}},62714:(e,t,s)=>{"use strict";async function r(e){try{let t=await e.clone().json();if("string"==typeof t?.error&&t.error.trim())return t.error;if(t?.error)return JSON.stringify(t.error)}catch{}try{let t=await e.clone().text();if(t.trim())return t}catch{}return`API request failed: ${e.status}`}async function a(e,t){let a=function(){let{headers:e,cookies:t}=s(40521),r=e(),a=t(),n=r.get("x-forwarded-host")??r.get("host"),i=r.get("x-forwarded-proto")??"http";return{baseUrl:n?`${i}://${n}`:"http://localhost:3000",cookieHeader:a.getAll().map(e=>`${e.name}=${e.value}`).join("; ")}}(),n=a?.baseUrl??"",i=await fetch(`${n}${e}`,{...t,headers:{"Content-Type":"application/json",...a?.cookieHeader?{cookie:a.cookieHeader}:{},...t?.headers??{}},cache:"no-store"});if(!i.ok)throw Error(await r(i));return i.json()}async function n(e,t){let s=await a(e,{...t,headers:{...t?.headers??{}}});if(!s.success)throw Error(String(s.error??"Request failed"));return s.data}s.d(t,{h:()=>i});let i={getContacts:()=>n("/api/contacts"),getProjects:()=>n("/api/projects"),getMilestones:()=>n("/api/milestones"),getInvoices:()=>n("/api/invoices"),getActivities:()=>n("/api/activities"),createContact:e=>n("/api/contacts",{method:"POST",body:JSON.stringify(e)}),updateContact:(e,t)=>n(`/api/contacts/${e}`,{method:"PATCH",body:JSON.stringify(t)}),deleteContact:e=>n(`/api/contacts/${e}`,{method:"DELETE"}),createProject:e=>n("/api/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>n(`/api/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),deleteProject:e=>n(`/api/projects/${e}`,{method:"DELETE"}),createMilestone:e=>n("/api/milestones",{method:"POST",body:JSON.stringify(e)}),updateMilestone:(e,t)=>n(`/api/milestones/${e}`,{method:"PATCH",body:JSON.stringify(t)}),deleteMilestone:e=>n(`/api/milestones/${e}`,{method:"DELETE"}),createInvoice:e=>n("/api/invoices",{method:"POST",body:JSON.stringify(e)}),updateInvoice:(e,t)=>n(`/api/invoices/${e}`,{method:"PATCH",body:JSON.stringify(t)}),deleteInvoice:e=>n(`/api/invoices/${e}`,{method:"DELETE"}),createActivity:e=>n("/api/activities",{method:"POST",body:JSON.stringify(e)}),getAudit:()=>n("/api/audit"),createAudit:e=>n("/api/audit",{method:"POST",body:JSON.stringify(e)}),getUsers:()=>n("/api/admin/users"),createUser:e=>n("/api/admin/users",{method:"POST",body:JSON.stringify(e)}),updateUser:(e,t)=>n(`/api/admin/users/${e}`,{method:"PATCH",body:JSON.stringify(t)}),removeUserFromWorkspace:e=>n(`/api/admin/users/${e}`,{method:"DELETE"}),getInvites:()=>n("/api/admin/invites"),createInvite:e=>n("/api/admin/invites",{method:"POST",body:JSON.stringify(e)}),revokeInvite:e=>n(`/api/admin/invites/${e}`,{method:"PATCH",body:JSON.stringify({status:"revoked"})}),getSettings:()=>n("/api/admin/settings"),updateSettings:e=>n("/api/admin/settings",{method:"PUT",body:JSON.stringify(e)}),exportBackup:()=>n("/api/admin/backup/export"),importBackup:e=>n("/api/admin/backup/import",{method:"POST",body:JSON.stringify(e)}),getEmailTemplate:()=>n("/api/users/me/template"),saveEmailTemplate:e=>n("/api/users/me/template",{method:"PUT",body:JSON.stringify({template:e})}),getNotifications:()=>n("/api/notifications"),createNotification:e=>n("/api/notifications",{method:"POST",body:JSON.stringify(e)}),markNotificationsRead:()=>n("/api/notifications/mark-read",{method:"POST"}),getWorkspaces:()=>n("/api/workspaces"),deleteWorkspace:e=>n(`/api/workspaces/${e}`,{method:"DELETE"}),updateWorkspace:(e,t)=>n(`/api/workspaces/${e}`,{method:"PATCH",body:JSON.stringify(t)})}},35224:(e,t,s)=>{"use strict";s.d(t,{HM:()=>c,cF:()=>o,lb:()=>d,mn:()=>l,p6:()=>i});var r=s(94830),a=s(99848),n=s(2125);function i(e){let t="string"==typeof e?(0,r.D)(e):e;return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(t)}function l(e){let t="string"==typeof e?(0,r.D)(e):e;return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(t)}function o(e,t=new Date){return(0,a.R)((0,r.D)(e),t)}function c(e,t=new Date){return(0,n.K)((0,r.D)(e),t)}function d(e,t="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:t,maximumFractionDigits:0}).format(e)}},75468:(e,t,s)=>{"use strict";s.d(t,{O:()=>c,f:()=>o});var r=s(97247),a=s(28964),n=s(77081),i=s(62714);let l=a.createContext(null);function o({children:e}){let t=(0,n.q)(),[s,o]=a.useState([]),[c,d]=a.useState([]),[u,m]=a.useState([]),[h,x]=a.useState([]);return a.useEffect(()=>{let e=!0;return async function(){try{let[t,s,r,a]=await Promise.all([i.h.getContacts(),i.h.getProjects(),i.h.getInvoices(),i.h.getMilestones()]);if(!e)return;o(t??[]),d(s??[]),x(r??[]),m(a??[])}catch{if(!e)return;o([]),d([]),x([]),m([])}}(),()=>{e=!1}},[t]),r.jsx(l.Provider,{value:{contacts:s,projects:c,milestones:u,invoices:h,setContacts:o,setProjects:d,setMilestones:m,setInvoices:x},children:e})}function c(){let e=a.useContext(l);if(!e)throw Error("useLocalData must be used within LocalDataProvider");return e}},92706:(e,t,s)=>{"use strict";s.d(t,{Fs:()=>a});let r={owner:["contacts:create","contacts:edit","contacts:archive","contacts:restore","contacts:delete","projects:create","projects:edit","projects:archive","projects:restore","projects:delete","milestones:update","crm:move_stage","invoices:create","invoices:edit_draft","invoices:view_basic","invoices:view_amounts","invoices:archive","invoices:restore","invoices:mark_paid","invoices:delete","followups:update","finance:view_sensitive","system:reset","users:manage"],editor:["contacts:create","contacts:edit","contacts:archive","contacts:restore","projects:create","projects:edit","projects:archive","projects:restore","milestones:update","crm:move_stage","invoices:create","invoices:edit_draft","invoices:view_basic","invoices:archive","invoices:restore","followups:update"]};function a(e,t){return"owner"===e||r[e].includes(t)}},77081:(e,t,s)=>{"use strict";s.d(t,{q:()=>a});var r=s(28964);function a(){let[e,t]=(0,r.useState)("editor");return e}},1121:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(72051),a=s(45347);let n=(0,a.createProxy)(String.raw`F:\Coding\Flowlane\src\components\layout\Sidebar.tsx#Sidebar`),i=(0,a.createProxy)(String.raw`F:\Coding\Flowlane\src\components\layout\TopBar.tsx#TopBar`),l=(0,a.createProxy)(String.raw`F:\Coding\Flowlane\src\components\layout\AppProviders.tsx#AppProviders`);var o=s(73275);async function c({children:e}){let t=await (0,o.XC)(),s="owner"===t||"editor"===t?t:null,[a,c]=await Promise.all([(0,o.ts)(),(0,o.hg)()]),d=a?.role==="owner"||a?.role==="editor"?a.role:null,u=a&&d?{role:d,name:a.name,avatarUrl:a.avatarUrl??""}:null,m=c.find(e=>e.isActive)??null;return r.jsx(l,{children:(0,r.jsxs)("div",{className:"flex h-screen w-full overflow-hidden",children:[r.jsx(n,{initialRole:s}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[r.jsx(i,{initialRole:s,initialUser:u,initialWorkspaces:c,initialActiveWorkspaceId:m?.id??""}),r.jsx("main",{className:"flex-1 overflow-y-auto bg-muted/30 px-8 py-6",children:e})]})]})})}var d=s(41288);async function u({children:e}){return await (0,o.ts)()||(0,d.redirect)("/signin"),r.jsx(c,{children:e})}}};