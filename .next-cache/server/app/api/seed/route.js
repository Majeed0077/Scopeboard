"use strict";(()=>{var e={};e.id=2520,e.ids=[2520],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},82729:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>k,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>v,staticGenerationAsyncStorage:()=>I});var a={};r.r(a),r.d(a,{POST:()=>S});var n=r(73278),i=r(45002),o=r(54877),d=r(71309),s=r(48948),c=r(73275),l=r(49888),p=r(65278),u=r(57502),m=r(97713),y=r(10197),g=r(14961),w=r(14163);async function S(e){let t;try{t=await (0,c.MH)(e,"Owner")}catch{return d.NextResponse.json({success:!1,error:"Forbidden"},{status:403})}await (0,s.C)();let r={workspaceId:t.workspaceId};return await Promise.all([l.V.deleteMany(r),p.X.deleteMany(r),u.S.deleteMany(r),m.p.deleteMany(r)]),await l.V.insertMany(y.J.map(e=>({_id:e.id,...e,workspaceId:t.workspaceId}))),await p.X.insertMany(g.q.map(e=>({_id:e.id,...e,workspaceId:t.workspaceId}))),await u.S.insertMany(w.E.map(e=>({_id:e.id,...e,workspaceId:t.workspaceId}))),d.NextResponse.json({success:!0,data:{seeded:!0}})}let f=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/seed/route",pathname:"/api/seed",filename:"route",bundlePath:"app/api/seed/route"},resolvedPagePath:"F:\\Coding\\Flowlane\\src\\app\\api\\seed\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:I,serverHooks:v}=f,k="/api/seed/route";function x(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:I})}},10197:(e,t,r)=>{r.d(t,{J:()=>a});let a=[{id:"c-001",name:"Nora Bennett",company:"Lumen Studio",email:"nora@lumen.studio",phone:"+1 415 555 0142",whatsapp:"+14155550142",source:"referral",stage:"proposal",nextFollowUpAt:"2026-02-05T10:00:00Z",tags:["branding","priority"],archived:!1,notes:[{id:"n-001",body:"Requested a revised scope for the Brand Sprint.",createdAt:"2026-02-03T14:30:00Z"}]},{id:"c-002",name:"Julian Ortiz",company:"Northwind Labs",email:"julian@northwind.io",phone:"+1 212 555 0198",whatsapp:"+12125550198",source:"linkedin",stage:"meeting",nextFollowUpAt:"2026-02-06T16:00:00Z",tags:["product"],archived:!1,notes:[{id:"n-002",body:"Wants to see a product analytics case study.",createdAt:"2026-02-01T09:12:00Z"}]},{id:"c-003",name:"Priya Shah",company:"Everbrite",email:"priya@everbrite.com",phone:"+1 646 555 0109",whatsapp:"+16465550109",source:"website",stage:"negotiation",nextFollowUpAt:"2026-02-04T11:00:00Z",tags:["retainer"],archived:!1,notes:[{id:"n-003",body:"Legal reviewing MSA; awaiting procurement confirmation.",createdAt:"2026-02-02T18:05:00Z"}]},{id:"c-004",name:"Miles Chen",company:"QuartzHealth",email:"miles@quartzhealth.co",phone:"+1 310 555 0175",whatsapp:"+13105550175",source:"event",stage:"contacted",nextFollowUpAt:"2026-02-07T15:00:00Z",tags:["health"],archived:!1,notes:[{id:"n-004",body:"Interested in UX audit + roadmap.",createdAt:"2026-01-29T13:40:00Z"}]},{id:"c-005",name:"Sabine Keller",company:"Aether Capital",email:"sabine@aether.capital",phone:"+1 617 555 0117",whatsapp:"+16175550117",source:"partner",stage:"won",nextFollowUpAt:"2026-02-12T09:30:00Z",tags:["enterprise"],archived:!1,notes:[{id:"n-005",body:"Won. Kickoff scheduled with ops.",createdAt:"2026-01-25T08:20:00Z"}]},{id:"c-006",name:"Damon Wright",company:"SignalLeaf",email:"damon@signalleaf.io",phone:"+1 206 555 0168",whatsapp:"+12065550168",source:"referral",stage:"new",nextFollowUpAt:"2026-02-05T13:00:00Z",tags:["webflow"],archived:!0,notes:[{id:"n-006",body:"Inbound referral from Greenline.",createdAt:"2026-02-05T08:05:00Z"}]}]},14163:(e,t,r)=>{r.d(t,{E:()=>a});let a=[{id:"i-001",invoiceNo:"VF-2026-014",contactId:"c-005",projectId:"p-001",status:"paid",issueDate:"2026-01-16",dueDate:"2026-01-30",currency:"USD",archived:!1,lineItems:[{title:"Discovery sprint",qty:1,rate:18e3}],payments:[{amount:18e3,method:"wire",paidAt:"2026-01-27",note:"Received via HSBC"}]},{id:"i-002",invoiceNo:"VF-2026-018",contactId:"c-003",projectId:"p-002",status:"overdue",issueDate:"2026-01-20",dueDate:"2026-02-03",currency:"USD",archived:!1,lineItems:[{title:"Retainer month 1",qty:1,rate:18e3}],payments:[]},{id:"i-003",invoiceNo:"VF-2026-021",contactId:"c-002",projectId:"p-004",status:"unpaid",issueDate:"2026-02-01",dueDate:"2026-02-15",currency:"USD",archived:!0,lineItems:[{title:"Product discovery",qty:1,rate:24e3}],payments:[]},{id:"i-004",invoiceNo:"VF-2026-025",contactId:"c-005",projectId:"p-001",status:"paid",issueDate:"2026-02-02",dueDate:"2026-02-16",currency:"USD",archived:!1,lineItems:[{title:"MVP wireframes",qty:1,rate:24e3}],payments:[{amount:24e3,method:"ach",paidAt:"2026-02-04",note:"Auto-processed"}]}]},14961:(e,t,r)=>{r.d(t,{q:()=>a});let a=[{id:"p-001",contactId:"c-005",title:"Aether Capital Investor Portal",status:"active",startDate:"2026-01-15",dueDate:"2026-03-20",budgetAmount:78e3,currency:"USD",links:["https://figma.com/aether-portal","https://drive.google.com/aether-portal","https://aethercapital.com/portal-preview"],archived:!1},{id:"p-002",contactId:"c-003",title:"Everbrite Retainer Q1",status:"active",startDate:"2026-01-05",dueDate:"2026-03-31",budgetAmount:54e3,currency:"USD",links:["https://github.com/agency/everbrite","https://drive.google.com/everbrite"],archived:!1},{id:"p-003",contactId:"c-001",title:"Lumen Studio Brand Sprint",status:"planning",startDate:"2026-02-10",dueDate:"2026-04-05",budgetAmount:32e3,currency:"USD",links:["https://figma.com/lumen-sprint"],archived:!1},{id:"p-004",contactId:"c-002",title:"Northwind Analytics MVP",status:"on_hold",startDate:"2025-11-01",dueDate:"2026-02-28",budgetAmount:9e4,currency:"USD",links:["https://github.com/agency/northwind"],archived:!0}]},73275:(e,t,r)=>{r.d(t,{KF:()=>A,MH:()=>h,XC:()=>k,Zk:()=>x,hg:()=>v,kt:()=>w,oT:()=>f,ts:()=>I,v6:()=>S});var a=r(52845),n=r(67370),i=r(32914),o=r(63253),d=r(82279),s=r(46993),c=r(48948);let l="vaultflow_session",p="vaultflow_workspace";function u(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET is not defined");return new TextEncoder().encode(e)}function m(e){return"owner"===e.toLowerCase()?"owner":"editor"}function y(e,t){if(!e)return"";for(let r of e.split(";").map(e=>e.trim()))if(r.startsWith(`${t}=`))return decodeURIComponent(r.slice(`${t}=`.length));return""}async function g(e,t,r){await (0,c.C)();let a=await o.T.findById(e).lean();if(!a||!a.isActive)return null;let n=r||t||a.workspaceId;if(n===a.workspaceId)return{workspaceId:n,role:m(a.role),email:a.email,name:a.name};let i=await s.N.findOne({userId:e,workspaceId:n,isActive:!0}).lean();return i?{workspaceId:n,role:"owner"===i.role?"owner":"editor",email:a.email,name:a.name}:{workspaceId:a.workspaceId,role:m(a.role),email:a.email,name:a.name}}async function w(e){let t=Math.floor(Date.now()/1e3);return new n.N(e).setProtectedHeader({alg:"HS256"}).setIssuedAt(t).setExpirationTime(t+604800).sign(u())}async function S(e){try{let t=e.headers.get("cookie"),r=y(t,l);if(!r)return null;let{payload:a}=await (0,i._)(r,u()),n="string"==typeof a.userId?a.userId:"",o="string"==typeof a.workspaceId?a.workspaceId:"",d=y(t,p);if(!n)return null;let s=await g(n,o,d);if(!s)return null;return{userId:n,workspaceId:s.workspaceId,role:s.role,email:s.email,name:s.name}}catch{return null}}async function f(e){let t=await S(e);if(!t)throw Error("Unauthorized");return t}async function h(e,t){let r=await f(e),a="owner"===t.toLowerCase()?"owner":"editor";if(r.role!==a)throw Error("Forbidden");return r}async function I(){let e=(0,a.cookies)(),t=e.get(l)?.value;if(!t)return null;try{let{payload:r}=await (0,i._)(t,u()),a="string"==typeof r.userId?r.userId:"",n="string"==typeof r.workspaceId?r.workspaceId:"",d=e.get(p)?.value??"";if(!a)return null;let s=await g(a,n,d);if(!s)return null;let c=await o.T.findById(a).lean();if(!c||!c.isActive)return null;return{id:String(c._id),workspaceId:s.workspaceId,name:c.name,email:c.email,role:s.role,avatarUrl:c.avatarUrl??""}}catch{return null}}async function v(){let e=await I();if(!e)return[];await (0,c.C)();let t=await o.T.findById(e.id).lean();if(!t)return[];let r=await s.N.find({userId:e.id,isActive:!0}).lean(),a=Array.from(new Set([String(t.workspaceId),...r.map(e=>String(e.workspaceId))])),n=await d.u.find({_id:{$in:a},isActive:!0}).lean();if(!n.some(e=>String(e._id)===String(t.workspaceId))){let e=await d.u.findOneAndUpdate({_id:String(t.workspaceId)},{_id:String(t.workspaceId),name:`${t.name}'s Workspace`,ownerUserId:String(t._id),isActive:!0},{upsert:!0,new:!0,setDefaultsOnInsert:!0}).lean();e&&n.push(e)}return a.map(a=>{let i=n.find(e=>String(e._id)===a),o=r.find(e=>String(e.workspaceId)===a),d=a===String(t.workspaceId)?"owner":o?.role==="owner"?"owner":"editor";return{id:a,name:i?.name??(a===String(t.workspaceId)?"My Workspace":`Workspace ${a.slice(0,6)}`),logoUrl:i?.logoUrl??"",role:d,isPersonal:a===String(t.workspaceId),isActive:a===e.workspaceId}})}async function k(){let e=await I();return e?.role??null}async function x(){return l}async function A(){return p}},48948:(e,t,r)=>{r.d(t,{C:()=>d});var a=r(11185),n=r.n(a);let i=process.env.MONGODB_URI;if(!i)throw Error("MONGODB_URI is not defined");let o=global.mongoose??{conn:null,promise:null};async function d(){return o.conn||(o.promise||(o.promise=n().connect(i).then(e=>e)),o.conn=await o.promise,global.mongoose=o),o.conn}},97713:(e,t,r)=>{r.d(t,{p:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({_id:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},entityType:{type:String,required:!0},entityId:{type:String,required:!0},action:{type:String,required:!0},message:{type:String},userRole:{type:String}},{timestamps:!0});i.index({workspaceId:1,entityType:1,entityId:1,createdAt:-1});let o=n().models.Activity||n().model("Activity",i)},49888:(e,t,r)=>{r.d(t,{V:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({_id:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},name:{type:String,required:!0},email:{type:String,default:""},phone:{type:String,default:""},company:{type:String,default:""},source:{type:String,default:"other"},sourceLabel:{type:String},stage:{type:String,default:"new"},nextFollowUpAt:{type:String},followUpCadence:{type:String,default:"none"},followUpIntervalDays:{type:Number,default:0},tags:{type:[String],default:[]},notes:{type:[{id:String,body:String,createdAt:String}],default:[]},archived:{type:Boolean,default:!1}},{timestamps:!0});i.index({workspaceId:1,stage:1,archived:1}),i.index({workspaceId:1,nextFollowUpAt:1}),i.index({workspaceId:1,updatedAt:-1});let o=n().models.Contact||n().model("Contact",i)},57502:(e,t,r)=>{r.d(t,{S:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({_id:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},invoiceNo:{type:String,required:!0},projectId:{type:String,required:!0},contactId:{type:String,required:!0},status:{type:String,enum:["draft","sent","paid","overdue","unpaid"],default:"unpaid"},issueDate:{type:String},dueDate:{type:String},paidDate:{type:String},amount:{type:Number},currency:{type:String,default:"USD"},lineItems:{type:[{title:String,qty:Number,rate:Number}],default:[]},payments:{type:[{amount:Number,method:String,paidAt:String,note:String}],default:[]},archived:{type:Boolean,default:!1}},{timestamps:!0});i.index({workspaceId:1,invoiceNo:1},{unique:!0}),i.index({workspaceId:1,status:1,archived:1}),i.index({workspaceId:1,dueDate:1}),i.index({workspaceId:1,projectId:1});let o=n().models.Invoice||n().model("Invoice",i)},65278:(e,t,r)=>{r.d(t,{X:()=>d});var a=r(11185),n=r.n(a);let i=new a.Schema({id:String,name:String,url:String,type:String,size:Number},{_id:!1}),o=new a.Schema({_id:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},contactId:{type:String,required:!1,default:void 0},clientName:{type:String},title:{type:String,required:!0},name:{type:String},status:{type:String,default:"planning"},pipelineStage:{type:String},notes:{type:String},attachments:{type:[i],default:[]},startDate:{type:String},dueDate:{type:String},budgetAmount:{type:Number,default:0},currency:{type:String,default:"USD"},links:{type:[String],default:[]},archived:{type:Boolean,default:!1}},{timestamps:!0});o.index({workspaceId:1,status:1,archived:1}),o.index({workspaceId:1,contactId:1}),o.index({workspaceId:1,dueDate:1}),o.index({workspaceId:1,updatedAt:-1}),n().models.Project&&n().deleteModel("Project");let d=n().models.Project||n().model("Project",o)},63253:(e,t,r)=>{r.d(t,{T:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({email:{type:String,required:!0,lowercase:!0},name:{type:String,required:!0},role:{type:String,enum:["Owner","Editor"],required:!0},passwordHash:{type:String,required:!0},workspaceId:{type:String,required:!0,index:!0,default:"default"},isActive:{type:Boolean,default:!0},invoiceEmailTemplate:{type:String,default:""},avatarUrl:{type:String,default:""}},{timestamps:!0});i.index({email:1},{unique:!0}),i.index({workspaceId:1,role:1}),i.index({workspaceId:1,isActive:1});let o=n().models.User||n().model("User",i)},82279:(e,t,r)=>{r.d(t,{u:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({_id:{type:String,required:!0},name:{type:String,required:!0},logoUrl:{type:String,default:""},ownerUserId:{type:String,required:!0},isActive:{type:Boolean,default:!0}},{timestamps:!0}),o=n().models.Workspace||n().model("Workspace",i)},46993:(e,t,r)=>{r.d(t,{N:()=>o});var a=r(11185),n=r.n(a);let i=new a.Schema({userId:{type:String,required:!0,index:!0},workspaceId:{type:String,required:!0,index:!0},role:{type:String,enum:["owner","editor"],required:!0},isActive:{type:Boolean,default:!0},invitedById:{type:String,default:""}},{timestamps:!0});i.index({workspaceId:1,userId:1},{unique:!0}),i.index({userId:1,isActive:1});let o=n().models.WorkspaceMembership||n().model("WorkspaceMembership",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9379,6936,2960,4833],()=>r(82729));module.exports=a})();