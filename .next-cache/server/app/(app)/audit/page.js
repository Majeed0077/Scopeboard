(()=>{var e={};e.id=8717,e.ids=[8717],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},69523:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),a(87468),a(1121),a(90996),a(39707);var r=a(30170),s=a(45002),l=a(83876),n=a.n(l),i=a(66299),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let d=["",{children:["(app)",{children:["audit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,87468)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\audit\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,1121)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,39707)),"F:\\Coding\\Flowlane\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["F:\\Coding\\Flowlane\\src\\app\\(app)\\audit\\page.tsx"],u="/(app)/audit/page",x={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(app)/audit/page",pathname:"/audit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},66712:(e,t,a)=>{Promise.resolve().then(a.bind(a,91057))},91057:(e,t,a)=>{"use strict";a.d(t,{AuditLogTable:()=>m});var r=a(97247),s=a(28964),l=a(85426),n=a(55757),i=a(87597),o=a(46444),d=a(35224),c=a(69065),u=a(58760);let x=[{value:"all",label:"All entities"},{value:"contact",label:"Contacts"},{value:"project",label:"Projects"},{value:"invoice",label:"Invoices"},{value:"milestone",label:"Milestones"},{value:"system",label:"System"}],p=[{value:"all",label:"All roles"},{value:"owner",label:"Owner"},{value:"editor",label:"Editor"}];function m({items:e}){let[t,a]=(0,s.useState)(""),[m,f]=(0,s.useState)("all"),[h,j]=(0,s.useState)("all"),g=(0,s.useMemo)(()=>{let a=t.trim().toLowerCase();return e.filter(e=>("all"===m||e.entityType===m)&&("all"===h||e.actorRole===h)&&(!a||e.action.toLowerCase().includes(a)||(e.meta??"").toLowerCase().includes(a)||(e.actorEmail??"").toLowerCase().includes(a)||(e.entityId??"").toLowerCase().includes(a)))},[e,t,m,h]);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(n.Zb,{className:"glass flex flex-wrap items-center gap-3 px-4 py-3",children:[r.jsx(l.I,{className:"h-9 w-[240px]",placeholder:"Search actions, actors, entities...",value:t,onChange:e=>a(e.target.value)}),(0,r.jsxs)(u.Ph,{value:m,onValueChange:f,children:[r.jsx(u.i4,{className:"w-[170px]",children:r.jsx(u.ki,{placeholder:"Entity"})}),r.jsx(u.Bw,{children:x.map(e=>r.jsx(u.Ql,{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)(u.Ph,{value:h,onValueChange:j,children:[r.jsx(u.i4,{className:"w-[150px]",children:r.jsx(u.ki,{placeholder:"Role"})}),r.jsx(u.Bw,{children:p.map(e=>r.jsx(u.Ql,{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[g.length," results"]})]}),0===g.length?r.jsx(o.u,{title:"No audit events yet",description:"Owner-only audit events will appear here."}):r.jsx("div",{className:"rounded-xl border bg-card",children:(0,r.jsxs)(c.iA,{children:[r.jsx(c.xD,{children:(0,r.jsxs)(c.SC,{children:[r.jsx(c.ss,{children:"Action"}),r.jsx(c.ss,{children:"Actor"}),r.jsx(c.ss,{children:"Entity"}),r.jsx(c.ss,{children:"Meta"}),r.jsx(c.ss,{className:"text-right",children:"Date"})]})}),r.jsx(c.RM,{children:g.map(e=>(0,r.jsxs)(c.SC,{children:[r.jsx(c.pj,{className:"font-medium",children:e.action}),r.jsx(c.pj,{children:(0,r.jsxs)("div",{className:"flex flex-col text-xs",children:[r.jsx("span",{children:e.actorEmail??"System"}),e.actorRole?r.jsx(i.C,{variant:"secondary",className:"mt-1 w-fit",children:e.actorRole}):null]})}),(0,r.jsxs)(c.pj,{className:"text-xs text-muted-foreground",children:[e.entityType??"—",e.entityId?` \xb7 ${e.entityId}`:""]}),r.jsx(c.pj,{className:"text-xs text-muted-foreground",children:e.meta??"—"}),r.jsx(c.pj,{className:"text-right text-xs text-muted-foreground",children:(0,d.p6)(e.createdAt)})]},e.id))})]})})]})}},46444:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});var r=a(97247),s=a(28852),l=a(79175);function n({title:e,description:t,actionLabel:a="Quick Add"}){return(0,r.jsxs)("div",{className:"rounded-lg border border-dashed bg-background p-8 text-center",children:[r.jsx("p",{className:"text-sm font-semibold",children:e}),r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:t}),r.jsx("div",{className:"mt-4 flex items-center justify-center",children:r.jsx(l.A,{children:r.jsx(s.z,{children:a})})})]})}},55757:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>i,Zb:()=>n,aY:()=>d,ll:()=>o});var r=a(97247),s=a(28964),l=a(40677);let n=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let i=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let o=s.forwardRef(({className:e,...t},a)=>r.jsx("h3",{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle",s.forwardRef(({className:e,...t},a)=>r.jsx("p",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription";let d=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",s.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},69065:(e,t,a)=>{"use strict";a.d(t,{RM:()=>o,SC:()=>d,iA:()=>n,pj:()=>u,ss:()=>c,xD:()=>i});var r=a(97247),s=a(28964),l=a(40677);let n=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("table",{ref:a,className:(0,l.cn)("w-full caption-bottom text-sm",e),...t})}));n.displayName="Table";let i=s.forwardRef(({className:e,...t},a)=>r.jsx("thead",{ref:a,className:(0,l.cn)("[&_tr]:border-b",e),...t}));i.displayName="TableHeader";let o=s.forwardRef(({className:e,...t},a)=>r.jsx("tbody",{ref:a,className:(0,l.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody";let d=s.forwardRef(({className:e,...t},a)=>r.jsx("tr",{ref:a,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=s.forwardRef(({className:e,...t},a)=>r.jsx("th",{ref:a,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground",e),...t}));c.displayName="TableHead";let u=s.forwardRef(({className:e,...t},a)=>r.jsx("td",{ref:a,className:(0,l.cn)("p-4 align-middle",e),...t}));u.displayName="TableCell",s.forwardRef(({className:e,...t},a)=>r.jsx("caption",{ref:a,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},87468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(72051),s=a(4767);let l=(0,a(45347).createProxy)(String.raw`F:\Coding\Flowlane\src\components\audit\AuditLogTable.tsx#AuditLogTable`);async function n(){try{return(await (0,s.S)("/api/audit")).data??[]}catch{return[]}}async function i(){let e=await n();return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"Audit Log"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Owner-only history of sensitive actions across Flowlane."})]}),r.jsx(l,{items:e})]})}},4767:(e,t,a)=>{"use strict";async function r(e){try{let t=await e.clone().json();if("string"==typeof t?.error&&t.error.trim())return t.error;if(t?.error)return JSON.stringify(t.error)}catch{}try{let t=await e.clone().text();if(t.trim())return t}catch{}return`API request failed: ${e.status}`}async function s(e,t){let s=function(){let{headers:e,cookies:t}=a(52845),r=e(),s=t(),l=r.get("x-forwarded-host")??r.get("host"),n=r.get("x-forwarded-proto")??"http";return{baseUrl:l?`${n}://${l}`:"http://localhost:3000",cookieHeader:s.getAll().map(e=>`${e.name}=${e.value}`).join("; ")}}(),l=s?.baseUrl??"",n=await fetch(`${l}${e}`,{...t,headers:{"Content-Type":"application/json",...s?.cookieHeader?{cookie:s.cookieHeader}:{},...t?.headers??{}},cache:"no-store"});if(!n.ok)throw Error(await r(n));return n.json()}a.d(t,{S:()=>s})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[9379,6936,2960,401,4564,4080,3997,9324,5665,7372,5411],()=>a(69523));module.exports=r})();