(()=>{var e={};e.id=6259,e.ids=[6259],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},44302:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o}),t(90653),t(82807),t(1121),t(90996),t(39707);var r=t(30170),a=t(45002),n=t(83876),i=t.n(n),l=t(66299),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["(app)",{children:["invoices",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,90653)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\invoices\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(t.bind(t,82807)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\invoices\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1121)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,39707)),"F:\\Coding\\Flowlane\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["F:\\Coding\\Flowlane\\src\\app\\(app)\\invoices\\page.tsx"],u="/(app)/invoices/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(app)/invoices/page",pathname:"/invoices",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},64190:(e,s,t)=>{Promise.resolve().then(t.bind(t,48310))},35303:()=>{},48310:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var r=t(97247),a=t(28964),n=t(34178),i=t(79906),l=t(69065),d=t(58760),o=t(65678),c=t(35224),u=t(46444),p=t(14434),x=t(28852);let m=(0,t(26323).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var h=t(999);let f=[{value:"all",label:"All statuses"},{value:"unpaid",label:"Unpaid"},{value:"overdue",label:"Overdue"},{value:"paid",label:"Paid"}];function v({invoices:e,contacts:s,projects:t,initialFilter:n,initialStatus:v,isOwner:g}){let[j,b]=(0,a.useState)(v??"all"),[w,N]=(0,a.useState)("active"),y=(0,a.useMemo)(()=>{let s="all"===j?e:e.filter(e=>e.status===j),t="archived"===w?s.filter(e=>e.archived):s.filter(e=>!e.archived);if("thisMonthPaid"===n){let e=new Date;return t.filter(s=>s.payments.some(s=>{let t=new Date(s.paidAt);return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}))}return t},[e,j,n,w]),P=(0,a.useMemo)(()=>g?{unpaid:e.filter(e=>"unpaid"===e.status).reduce((e,s)=>e+s.lineItems.reduce((e,s)=>e+s.qty*s.rate,0),0),overdue:e.filter(e=>"overdue"===e.status).reduce((e,s)=>e+s.lineItems.reduce((e,s)=>e+s.qty*s.rate,0),0)}:null,[e,g]);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"glass flex flex-wrap items-center gap-3 rounded-xl px-4 py-3",children:[(0,r.jsxs)(d.Ph,{value:j,onValueChange:e=>b(e),children:[r.jsx(d.i4,{className:"w-[200px]",children:r.jsx(d.ki,{placeholder:"Filter status"})}),r.jsx(d.Bw,{children:f.map(e=>r.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]}),r.jsx(p.m,{permission:"invoices:delete",children:(0,r.jsxs)(d.Ph,{value:w,onValueChange:e=>N(e),children:[r.jsx(d.i4,{className:"w-[160px]",children:r.jsx(d.ki,{placeholder:"Visibility"})}),(0,r.jsxs)(d.Bw,{children:[r.jsx(d.Ql,{value:"active",children:"Active"}),r.jsx(d.Ql,{value:"archived",children:"Archived"})]})]})})]}),g&&P?(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{children:["Total unpaid"," ",r.jsx("span",{className:"font-semibold text-foreground",children:(0,c.lb)(P.unpaid,"USD")})]}),(0,r.jsxs)("span",{children:["Total overdue"," ",r.jsx("span",{className:"font-semibold text-foreground",children:(0,c.lb)(P.overdue,"USD")})]})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.jsx(m,{className:"h-3.5 w-3.5"}),"Amounts are hidden for Editors."]}),0===y.length?r.jsx(u.u,{title:"No invoices yet",description:"Create an invoice to track receivables and payments."}):r.jsx("div",{className:"rounded-xl border bg-card",children:(0,r.jsxs)(l.iA,{children:[r.jsx(l.xD,{children:(0,r.jsxs)(l.SC,{children:[r.jsx(l.ss,{children:"Invoice"}),r.jsx(l.ss,{children:"Client"}),r.jsx(l.ss,{children:"Project"}),r.jsx(l.ss,{children:"Status"}),r.jsx(l.ss,{children:"Due"}),g&&r.jsx(l.ss,{className:"text-right",children:"Amount"}),g&&r.jsx(l.ss,{className:"text-right",children:"Actions"})]})}),r.jsx(l.RM,{children:y.map(e=>{let a=s.find(s=>s.id===e.contactId),n=t.find(s=>s.id===e.projectId),d=g?e.lineItems.reduce((e,s)=>e+s.qty*s.rate,0):0;return(0,r.jsxs)(l.SC,{className:`hover:bg-muted/40 ${"overdue"===e.status?"border-l-4 border-rose-400":""}`,children:[r.jsx(l.pj,{children:r.jsx(i.default,{href:`/invoices/${e.id}`,className:"font-medium",children:e.invoiceNo})}),r.jsx(l.pj,{children:a?.company??"—"}),r.jsx(l.pj,{children:n?.title??"—"}),r.jsx(l.pj,{children:r.jsx(o.Q$,{status:e.status})}),r.jsx(l.pj,{children:(0,c.p6)(e.dueDate)}),g&&r.jsx(l.pj,{className:"text-right",children:(0,c.lb)(d,e.currency)}),g&&r.jsx(l.pj,{className:"text-right",children:r.jsx(x.z,{variant:"ghost",size:"icon",onClick:()=>{window.open(`/invoices/${e.id}?export=pdf`,"_blank")},children:r.jsx(h.Z,{className:"h-4 w-4"})})})]},e.id)})})]})})]})}var g=t(75468),j=t(77081),b=t(55757),w=t(26780),N=t(94830);function y(){let e=(0,n.useSearchParams)(),s=e.get("status"),t=e.get("filter")??void 0,{invoices:i,contacts:l,projects:d}=(0,g.O)(),o="owner"===(0,j.q)(),u=(0,a.useMemo)(()=>o?{unpaid:i.filter(e=>"unpaid"===e.status).reduce((e,s)=>e+s.lineItems.reduce((e,s)=>e+s.qty*s.rate,0),0),overdue:i.filter(e=>"overdue"===e.status).reduce((e,s)=>e+s.lineItems.reduce((e,s)=>e+s.qty*s.rate,0),0),thisMonthPaid:i.flatMap(e=>e.payments).filter(e=>(0,w.x)((0,N.D)(e.paidAt),new Date)).reduce((e,s)=>e+s.amount,0)}:null,[i,o]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"Invoices"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Track billing status and incoming payments."})]}),u?(0,r.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,r.jsxs)(b.Zb,{className:"glass p-4",children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total unpaid"}),r.jsx("p",{className:"text-lg font-semibold",children:(0,c.lb)(u.unpaid,"USD")})]}),(0,r.jsxs)(b.Zb,{className:"glass p-4",children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Total overdue"}),r.jsx("p",{className:"text-lg font-semibold",children:(0,c.lb)(u.overdue,"USD")})]}),(0,r.jsxs)(b.Zb,{className:"glass p-4",children:[r.jsx("p",{className:"text-xs text-muted-foreground",children:"Paid this month"}),r.jsx("p",{className:"text-lg font-semibold",children:(0,c.lb)(u.thisMonthPaid,"USD")})]})]}):null,r.jsx(v,{invoices:i,contacts:l,projects:d,initialStatus:"unpaid"===s||"overdue"===s||"paid"===s?s:void 0,initialFilter:t,isOwner:o})]})}},46444:(e,s,t)=>{"use strict";t.d(s,{u:()=>i});var r=t(97247),a=t(28852),n=t(79175);function i({title:e,description:s,actionLabel:t="Quick Add"}){return(0,r.jsxs)("div",{className:"rounded-lg border border-dashed bg-background p-8 text-center",children:[r.jsx("p",{className:"text-sm font-semibold",children:e}),r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:s}),r.jsx("div",{className:"mt-4 flex items-center justify-center",children:r.jsx(n.A,{children:r.jsx(a.z,{children:t})})})]})}},14434:(e,s,t)=>{"use strict";t.d(s,{$:()=>c,m:()=>o});var r=t(97247),a=t(28964),n=t(17818),i=t(70887),l=t(92706),d=t(77081);function o({permission:e,children:s}){let t=(0,d.q)();return(0,l.Fs)(t,e)?r.jsx(r.Fragment,{children:s}):null}function c({permission:e,children:s,tooltip:t="Owner only"}){let o=(0,d.q)();if((0,l.Fs)(o,e))return s;let c={...s.props,disabled:!0,onClick:e=>{e.preventDefault(),n.A.error("Only the owner can do this.")}};return r.jsx(i.pn,{children:(0,r.jsxs)(i.u,{children:[r.jsx(i.aJ,{asChild:!0,children:Object.assign(a.cloneElement(s,c))}),r.jsx(i._v,{children:t})]})})}},65678:(e,s,t)=>{"use strict";t.d(s,{$x:()=>l,Pm:()=>i,Q$:()=>o,lo:()=>d});var r=t(97247),a=t(87597),n=t(18171);function i({stage:e}){return r.jsx(a.C,{variant:n.e0[e],children:n.c8[e]})}function l({status:e}){return r.jsx(a.C,{variant:n.lh[e],children:n.BO[e]})}function d({status:e}){return r.jsx(a.C,{variant:n.$M[e],children:n.ps[e]})}function o({status:e}){return r.jsx(a.C,{variant:n.v8[e],children:n.Ap[e]})}},55757:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>l,Zb:()=>i,aY:()=>o,ll:()=>d});var r=t(97247),a=t(28964),n=t(40677);let i=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let l=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let d=a.forwardRef(({className:e,...s},t)=>r.jsx("h3",{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));d.displayName="CardTitle",a.forwardRef(({className:e,...s},t)=>r.jsx("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...s})).displayName="CardDescription";let o=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",a.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},69065:(e,s,t)=>{"use strict";t.d(s,{RM:()=>d,SC:()=>o,iA:()=>i,pj:()=>u,ss:()=>c,xD:()=>l});var r=t(97247),a=t(28964),n=t(40677);let i=a.forwardRef(({className:e,...s},t)=>r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",e),...s})}));i.displayName="Table";let l=a.forwardRef(({className:e,...s},t)=>r.jsx("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",e),...s}));l.displayName="TableHeader";let d=a.forwardRef(({className:e,...s},t)=>r.jsx("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...s}));d.displayName="TableBody";let o=a.forwardRef(({className:e,...s},t)=>r.jsx("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));o.displayName="TableRow";let c=a.forwardRef(({className:e,...s},t)=>r.jsx("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground",e),...s}));c.displayName="TableHead";let u=a.forwardRef(({className:e,...s},t)=>r.jsx("td",{ref:t,className:(0,n.cn)("p-4 align-middle",e),...s}));u.displayName="TableCell",a.forwardRef(({className:e,...s},t)=>r.jsx("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption"},18171:(e,s,t)=>{"use strict";t.d(s,{$M:()=>c,AO:()=>p,Ap:()=>i,BO:()=>a,Dm:()=>l,c8:()=>r,e0:()=>d,lh:()=>o,ps:()=>n,v8:()=>u});let r={new:"New",contacted:"Contacted",meeting:"Meeting",proposal:"Proposal",negotiation:"Negotiation",won:"Won",lost:"Lost"},a={planning:"Planning",active:"Active",on_hold:"On Hold",completed:"Completed"},n={pending:"Pending",in_progress:"In Progress",blocked:"Blocked",done:"Done",waiting_client:"Waiting on Client"},i={unpaid:"Unpaid",overdue:"Overdue",paid:"Paid"},l={upwork:"Upwork",linkedin:"LinkedIn",referral:"Referral",website:"Website",local:"Local",partner:"Partner",event:"Event",other:"Other"},d={new:"info",contacted:"secondary",meeting:"warning",proposal:"warning",negotiation:"warning",won:"success",lost:"danger"},o={planning:"secondary",active:"success",on_hold:"warning",completed:"muted"},c={pending:"secondary",in_progress:"warning",blocked:"danger",done:"success",waiting_client:"warning"},u={unpaid:"secondary",overdue:"warning",paid:"success"},p={upwork:"info",linkedin:"secondary",referral:"success",website:"info",local:"muted",partner:"success",event:"muted",other:"muted"}},82807:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var r=t(72051),a=t(4615);function n(){return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx(a.O,{className:"h-6 w-36"}),r.jsx(a.O,{className:"mt-2 h-4 w-64"})]}),r.jsx(a.O,{className:"h-10 w-48"}),r.jsx(a.O,{className:"h-64 w-full"})]})}},90653:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(45347).createProxy)(String.raw`F:\Coding\Flowlane\src\app\(app)\invoices\page.tsx#default`)},4615:(e,s,t)=>{"use strict";t.d(s,{O:()=>n});var r=t(72051),a=t(39812);function n({className:e}){return r.jsx("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",e)})}},39812:(e,s,t)=>{"use strict";t.d(s,{cn:()=>n});var r=t(36272),a=t(51472);function n(...e){return(0,a.m6)((0,r.W)(e))}},26780:(e,s,t)=>{"use strict";t.d(s,{x:()=>a});var r=t(82505);function a(e,s){let t=(0,r.Q)(e),a=(0,r.Q)(s);return t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9379,6936,2960,401,4564,4080,3997,9324,5665,1181,7372,5411],()=>t(44302));module.exports=r})();