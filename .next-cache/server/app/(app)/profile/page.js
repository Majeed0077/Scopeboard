(()=>{var e={};e.id=5915,e.ids=[5915],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},3593:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(35834),t(1121),t(90996),t(39707);var r=t(30170),s=t(45002),l=t(83876),i=t.n(l),n=t(66299),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(a,o);let d=["",{children:["(app)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,35834)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\profile\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1121)),"F:\\Coding\\Flowlane\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,39707)),"F:\\Coding\\Flowlane\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["F:\\Coding\\Flowlane\\src\\app\\(app)\\profile\\page.tsx"],p="/(app)/profile/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(app)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},84114:(e,a,t)=>{Promise.resolve().then(t.bind(t,90657))},90657:(e,a,t)=>{"use strict";t.d(a,{ProfileClient:()=>p});var r=t(97247),s=t(28964),l=t(44597),i=t(17818),n=t(28852),o=t(55757),d=t(85426),c=t(51740);function p({initialProfile:e}){let[a,t]=(0,s.useState)(e??null),[p,u]=(0,s.useState)(e?.name??""),[m,f]=(0,s.useState)(e?.avatarUrl??""),[x,h]=(0,s.useState)(!1),v=(0,s.useRef)(null);async function g(e){let a=new FormData;a.append("files",e);let t=await fetch("/api/uploads",{method:"POST",body:a}),r=await t.json().catch(()=>null);if(!t.ok||!r?.success||!r?.data?.length)throw Error(r?.error??"Upload failed");return r.data[0]?.url}async function j(e,a){let r=await fetch("/api/users/me",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.trim(),avatarUrl:a})}),s=await r.json().catch(()=>null);if(!r.ok||!s?.success)throw Error(s?.error??"Unable to update profile.");t(s.data),window.dispatchEvent(new Event("vaultflow-profile-updated"))}async function w(){if(!p.trim()){i.A.error("Name is required.");return}h(!0);try{await j(p,m),i.A.success("Profile updated.")}catch(e){i.A.error(e?.message??"Unable to update profile.")}finally{h(!1)}}return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"Profile"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your name and profile photo."})]}),(0,r.jsxs)(o.Zb,{className:"max-w-2xl p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[r.jsx("div",{className:"relative h-20 w-20 overflow-hidden rounded-full border bg-muted",children:m?r.jsx(l.default,{src:m,alt:"Avatar",fill:!0,className:"object-cover"}):r.jsx("div",{className:"flex h-full w-full items-center justify-center text-sm text-muted-foreground",children:a?.name?.charAt(0)?.toUpperCase()??"U"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-sm font-medium",children:"Profile photo"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx(n.z,{variant:"outline",onClick:()=>v.current?.click(),type:"button",children:"Upload photo"}),m?r.jsx(n.z,{variant:"ghost",type:"button",onClick:()=>f(""),children:"Remove"}):null]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, or WEBP. We store only a URL (no raw files in DB)."})]}),r.jsx("input",{ref:v,type:"file",accept:"image/*",className:"hidden",onChange:async e=>{let t=e.target.files?.[0];if(t)try{let e=await g(t);f(e),await j(p||a?.name||"User",e),i.A.success("Photo uploaded.")}catch(e){i.A.error(e?.message??"Upload failed.")}finally{e.target.value=""}}})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"name",children:"Full name"}),r.jsx(d.I,{id:"name",value:p,onChange:e=>u(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"email",children:"Email"}),r.jsx(d.I,{id:"email",value:a?.email??"",disabled:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"role",children:"Role"}),r.jsx(d.I,{id:"role",value:a?.role?a.role.toUpperCase():"",disabled:!0})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(n.z,{onClick:w,disabled:x,children:x?"Saving...":"Save changes"})})]})]})}},55757:(e,a,t)=>{"use strict";t.d(a,{Ol:()=>n,Zb:()=>i,aY:()=>d,ll:()=>o});var r=t(97247),s=t(28964),l=t(40677);let i=s.forwardRef(({className:e,...a},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow-sm",e),...a}));i.displayName="Card";let n=s.forwardRef(({className:e,...a},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...a}));n.displayName="CardHeader";let o=s.forwardRef(({className:e,...a},t)=>r.jsx("h3",{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));o.displayName="CardTitle",s.forwardRef(({className:e,...a},t)=>r.jsx("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...a})).displayName="CardDescription";let d=s.forwardRef(({className:e,...a},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",s.forwardRef(({className:e,...a},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},35834:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i});var r=t(72051),s=t(73275);let l=(0,t(45347).createProxy)(String.raw`F:\Coding\Flowlane\src\components\profile\ProfileClient.tsx#ProfileClient`);async function i(){let e=await (0,s.ts)(),a=e?{id:String(e.id),name:e.name,email:e.email,role:"owner"===e.role?"owner":"editor",avatarUrl:e.avatarUrl??""}:null;return r.jsx(l,{initialProfile:a})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[9379,6936,2960,401,4564,4080,3997,9324,5665,7372,5411],()=>t(3593));module.exports=r})();